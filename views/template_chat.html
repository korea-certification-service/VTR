<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Chat Template</title>
<link rel="stylesheet" href="/css/backup/vtr.css">
</head>
<body>
    <div class="chat_wrap" id="chatWrap">
        <header class="header">
            <div class="hdr_menu cf">
                <p class="status_text">Status : <em id="statusText"></em></p>
                <a class="btn_trans" href="https://translate.google.com/" target="_blank">Translate</a>
            </div>
            <h1 class="cf">
                <div class="vtr_category" id="vtrCategory">게임아이템</div>
                <div class="vtr_title ellipse" id="vtrTitle">세라핌  팝니다</div>
                <div class="vtr_price" id="vtrPrice"><span id="vtrPriceNum">11</span> MACH</div>
            </h1>
            <button id="btnOut" class="btn_out"><img src="/img/ico_exit.png" alt="나가기"></button>
        </header>
        <div class="content" id="content">
            <em class="other_id">other</em>
            <div class="bubble other_speech"><p>안녕하세요 &#128513;</p></div>
            <div class="bubble other_speech">
                <p>
                    거래 요청 드립니다
                    <span class="chat_time">오전 1:47</span>
                </p>
            </div>
            <em class="my_id">imymemine</em>
            <div class="bubble my_speech"><p>넹 &#128513;</p></div>
            <div class="bubble my_speech">
                <p>
                    말씀하세요.말씀하세요.말씀하세요.말씀하세요.말씀하세요.말씀하세요.말씀하세요.말씀하세요.말씀하세요.말씀하세요.
                    <span class="chat_time">오후 11:07</span>
                </p>
            </div>
            <div class="ymd">2019년 6월 14일</div>
            <em class="mach_id">chatbot</em>
            <div class="bubble mach_speech"><p>거래 진행은 판매자만 가능합니다.거래 진행은 판매자만 가능합니다.거래 진행은 판매자만 가능합니다.거래 진행은 판매자만 가능합니다.</p></div>
            <div class="chat_dim" id="chatDim"></div>
            <em class="other_id">other</em>
            <div class="bubble other_speech"><p>안녕하세요 &#128513;</p></div>
            <div class="bubble other_speech"><p>거래 요청 드립니다</p></div>
            <em class="my_id">imymemine</em>
            <div class="bubble my_speech"><p>넹 &#128513;</p></div>
            <div class="bubble my_speech"><p>말씀하세요</p></div>
            <div class="ymd">2019년 6월 14일</div>
            <em class="mach_id">chatbot</em>
            <div class="bubble mach_speech"><p>거래 진행은 판매자만 가능합니다.</p></div>
            <div class="chat_dim" id="chatDim"></div>
        </div>
        <footer class="footer cf">
            <div class="msg_sec cf">
                <button class="btn_at" id="btnAt"><img src="/img/ico_@.png" alt="@"></button>
                <input type="text" class="ipt_chat" id="iptChat" placeholder="메세지를 입력하세요.">
                <button class="btn_emoji" id="btnEmoji"><img src="/img/ico_emoji.png" alt="emoji"></button>
                <button class="btn_send" id="btnSend">Send</button>
            </div>
            <div class="imoji_sec" id="imojiSec">
                <ul>
                    <li><img src="/img/imoji/imac_crying.gif" title="imac_crying" alt=""></li>
                    <li><img src="/img/imoji/imac_amazing.gif" title="imac_amazing" alt=""></li>
                    <li><img src="/img/imoji/imac_excited.gif" title="imac_excited" alt=""></li>
                    <li><img src="/img/imoji/imac_lame.gif" title="imac_lame" alt=""></li>
                </ul>
            </div>
            <div class="at_sec" id="atSec">
                <div class="mach_command machCmd">@마하 거래안내</div>
                <div class="mach_command machCmd sellerCmd">@마하 거래요청</div>
                <div class="mach_command machCmd sellerCmd">@마하 판매완료</div>
                <div class="mach_command machCmd">@마하 거래취소</div>
            </div>
        </footer>
    </div>
<script>
var chatUI = {
    isDim: false,
    init: function() {
        this.fnAt();
        this.fnImoji();
        this.orientationchange();
        this.sendMsg();
    },
    methodDim: {
        hideDim: function() {
            chatUI.isDim = false;
            document.getElementById("imojiSec").style.display="none";
            document.getElementById("atSec").style.display="none";
            document.getElementById("chatDim").style.display="none"; 
        },
        showDim: function(secId) {
            this.hideDim();
            chatUI.isDim = true;
            document.getElementById(secId).style.display="block";
            document.getElementById("chatDim").style.display="block";
        }
    },  
    fnAt: function() {
        var that = this;
        
        document.getElementById("btnAt").addEventListener("click", function(){
            that.methodDim.showDim("atSec");
        });

        document.getElementById("chatWrap").addEventListener("click", function(e){
            if(e.target.id === "chatDim" && that.isDim){
                that.methodDim.hideDim();
            }
        });

        var machCmd = document.querySelectorAll(".at_sec .machCmd");
        var iptChat = document.getElementById("iptChat");
        for (var i = 0; i < machCmd.length; i++) {
            machCmd[i].addEventListener("click", function(e){
                //console.log(e.target.innerText);
                iptChat.value = "";
                iptChat.value = e.target.innerText;
                that.methodDim.hideDim();
                // 여기서 메세지 입력되면 됨
                document.getElementById("btnSend").click();
                
                fnScrollLast(); // 스크롤 자동 최하단 이동
            });
        }
    },
    fnImoji: function() {
        var that = this;
        
        document.getElementById("btnEmoji").addEventListener("click", function(){
            that.methodDim.showDim("imojiSec");
        });

        document.getElementById("chatWrap").addEventListener("click", function(e){
            if(e.target.id === "chatDim" && that.isDim){
                that.methodDim.hideDim();
            }
        });

        var imoji = document.querySelectorAll(".imoji_sec li img");
        for (var i = 0; i < imoji.length; i++) {
            imoji[i].addEventListener("click", function(e){
                var title = e.currentTarget.getAttribute("title");
                fnSendMsg({imoji: title});

                that.methodDim.hideDim();
            });
        }
    },
    orientationchange: function() {
        window.addEventListener("orientationchange", function() {
            // window.orientation: 90 가로, 0 세로
            document.getElementById("content").addEventListener("click", function(){
                document.getElementById("chatDim").focus();
            });
        });        
    },
    sendMsg: function() {

    }
}    
chatUI.init();
</script>    
</body>
</html>